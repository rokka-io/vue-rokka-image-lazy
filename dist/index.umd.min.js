/*!
 * vue-rokka-image-lazy v0.0.1-dev
 * (c) 
 * Released under the ISC License.
 */
!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var e=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t){!function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n={alt:{type:String,default:null},title:{type:String,default:null},org:{type:String,default:""},stack:{type:String,default:"dynamic"},hash:{type:String,default:""},format:{type:String,default:"jpg"},filename:{type:String,default:"image"},srcAttribute:{type:String,default:"src"},srcAdditionalAttribute:{type:String,default:null},srcsetAttribute:{type:String,default:"srcset"},operations:{type:Array,default:function(){return[]}},options:{type:Object,default:function(){return{}}},variables:{type:Object,default:function(){return{}}}},a=function t(r){var n=[];return Object.keys(r).forEach(function(a){var o=r[a];if("object"===e(o)){var i=t(o);for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(Array.isArray(i)?n.push("".concat(a,"-").concat(i[s])):n.push("".concat(a,"-").concat(s,"-").concat(i[s])))}else n.push("".concat(a,"-").concat(o))}),n},o=function(t){var e,r,n=t.org,o=t.stack,i=t.variables,s=t.options,c=t.filename,d=t.format,u=t.hash,p=a({v:i}).join("--"),l=a({options:s}).join("--"),f=["".concat(n,".rokka.io/").concat(o),p,l,u,"".concat((e=c,r=e,r=(r=r.replace(/\.[^\/.]{2,4}$/,"")).replace(/[.\\\/]/g,"-")),".").concat(d)].join("/").replace(/\/{2,}/g,"/");return"https://"+f},i=function(t){return t&&"object"===e(t)&&!Array.isArray(t)},s=function t(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];if(!a.length)return e;var s=a.shift();if(i(e)&&i(s))for(var c in s)i(s[c])?(e[c]||Object.assign(e,r({},c,{})),t(e[c],s[c])):Object.assign(e,r({},c,s[c]));return t.apply(void 0,[e].concat(a))},c=function(t,e){var r=t.concat(e).reduce(function(t,e){return t[e.name]?t[e.name]=s(t[e.name],e):t[e.name]=e,t},{});return Object.keys(r).map(function(t){return r[t]})},d=function(t){var e=t.postfix,r=t.operations,n=t.options,a=t.variables,i=t.$parent&&t.$parent.$props&&t.$parent.$props.postfix,d=t.$parent&&t.$parent.$props&&t.$parent.$props.operations,u=t.$parent&&t.$parent.$props&&t.$parent.$props.options,p=t.$parent&&t.$parent.$props&&t.$parent.$props.variables,l=Math.max(Array.isArray(e)?e.length:0,Array.isArray(r)?r.length:0,Array.isArray(n)?n.length:0,Array.isArray(a)?a.length:0);"rokka-picture"===t.$parent.$options._componentTag&&(l=Math.max(l,Array.isArray(i)?i.length:0,Array.isArray(d)?d.length:0,Array.isArray(u)?u.length:0,Array.isArray(p)?p.length:0));for(var f=[],h=0;h<l;h++){var y=Array.isArray(e)?e[h]:e,g=Array.isArray(r)&&Array.isArray(r[0])?r[h]:r,A=Array.isArray(n)?n[h]:n,b=Array.isArray(a)?a[h]:a;if("rokka-picture"===t.$parent.$options._componentTag){var m=Array.isArray(d)&&Array.isArray(d[0])?d[h]:d,v=Array.isArray(u)?u[h]:u,k=Array.isArray(p)?p[h]:p;g=c(m,g),b=s(k,b),A=s(v,A)}A instanceof Array&&0===A.length&&(A={});var $=o(Object.assign({},t.$parent.$props,{},t.$options.propsData,{operations:g,variables:b,options:A}));$=encodeURI($)+(y?" "+y:""),f.push($)}return f.join(", ")},u={props:Object.assign({},n,{postfix:{type:[Object,Array],default:function(){return[]}},options:{type:[Object,Array],default:function(){return[]}},srcAdditional:{type:String,default:null}}),computed:{srcAdditionalComputed:function(){return this.srcAdditionalAttribute?this.srcAdditional?this.srcAdditional:this.rokkaSrc:null},rokkaSrcset:function(){return d(this)},rokkaSrc:function(){var t=this.operations,e=this.options,r=this.variables,n=this.$parent&&this.$parent.$props&&this.$parent.$props.operations,a=this.$parent&&this.$parent.$props&&this.$parent.$props.options,i=this.$parent&&this.$parent.$props&&this.$parent.$props.variables,d=Array.isArray(t)&&Array.isArray(t[0])?t[0]||{}:t,u=Array.isArray(e)?e[0]||{}:e,p=Array.isArray(r)?r[0]||{}:r,l=this.$props;if("rokka-picture"===this.$parent.$options._componentTag){var f=Array.isArray(n)&&Array.isArray(n[0])?n[0]:n,h=Array.isArray(a)?a[0]:a,y=Array.isArray(i)?i[0]:i;d=c(f,d),p=s(y,p),u=s(h,u),l=this.$options.propsData}var g=o(Object.assign({},this.$parent.$props,{},l,{operations:d,variables:p,options:u}));return g}}};function p(t,e,r,n,a,o,i,s,c,d){"boolean"!=typeof i&&(c=s,s=i,i=!1);const u="function"==typeof r?r.options:r;let p;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,a&&(u.functional=!0)),n&&(u._scopeId=n),o?(p=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=p):e&&(p=i?function(t){e.call(this,d(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),p)if(u.functional){const t=u.render;u.render=function(e,r){return p.call(r),t(e,r)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,p):[p]}return r}"undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var l=void 0,f=void 0,h=void 0,y=p({render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("img",t._b({class:"rokka--attr-"+t.srcAttribute,attrs:{alt:t.alt,title:t.title}},"img",t._d({},[t.srcAttribute,t.rokkaSrc,t.srcsetAttribute,t.rokkaSrcset,t.srcAdditionalAttribute,t.srcAdditionalComputed])))},staticRenderFns:[]},l,u,f,!1,h,!1,void 0,void 0,void 0),g={props:Object.assign({},n)},A=void 0,b=void 0,m=void 0,v=p({render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"rokka-picture"},[e("picture",[this._t("default")],2)])},staticRenderFns:[]},A,g,b,!1,m,!1,void 0,void 0,void 0),k={props:Object.assign({},n,{media:{type:String,default:""},postfix:{type:[Object,Array],default:function(){return[]}},options:{type:[Object,Array],default:function(){return[]}},variables:{type:[Object,Array],default:function(){return[]}}}),computed:{srcset:function(){return d(this)}}},$=void 0,_=void 0,O=void 0,C=p({render:function(){var t=this.$createElement,e=this._self._c||t;return e("source",{attrs:{media:this.media,srcset:this.srcset}})},staticRenderFns:[]},$,k,_,!1,O,!1,void 0,void 0,void 0);t.exports={RokkaImg:y,RokkaPicture:v,RokkaSource:C,rokkaUrl:o,default:{install:function(t){t.component("rokka-img",y),t.component("rokka-picture",v),t.component("rokka-source",C)}}}}()}),r=e.RokkaImg,n=(e.RokkaPicture,e.RokkaSource,e.rokkaUrl);const a="undefined"!=typeof document&&document.documentMode,o={rootMargin:"0px",threshold:0,load(t){if("picture"===t.nodeName.toLowerCase()){const e=document.createElement("img");a&&t.getAttribute("data-iesrc")&&(e.src=t.getAttribute("data-iesrc")),t.getAttribute("data-alt")&&(e.alt=t.getAttribute("data-alt")),t.append(e)}if("video"===t.nodeName.toLowerCase()&&!t.getAttribute("data-src")&&t.children){const e=t.children;let r;for(let t=0;t<=e.length-1;t++)(r=e[t].getAttribute("data-src"))&&(e[t].src=r);t.load()}if(t.getAttribute("data-src")&&(t.src=t.getAttribute("data-src")),t.getAttribute("data-srcset")&&t.setAttribute("srcset",t.getAttribute("data-srcset")),t.getAttribute("data-background-image"))t.style.backgroundImage=`url('${t.getAttribute("data-background-image").split(",").join("'),url('")}')`;else if(t.getAttribute("data-background-image-set")){const e=t.getAttribute("data-background-image-set").split(",");let r=e[0].substr(0,e[0].indexOf(" "))||e[0];r=-1===r.indexOf("url(")?`url(${r})`:r,1===e.length?t.style.backgroundImage=r:t.setAttribute("style",(t.getAttribute("style")||"")+`background-image: ${r}; background-image: -webkit-image-set(${e}); background-image: image-set(${e})`)}t.getAttribute("data-toggle-class")&&t.classList.toggle(t.getAttribute("data-toggle-class"))},loaded(){}};function i(t){t.setAttribute("data-loaded",!0)}const s=t=>"true"===t.getAttribute("data-loaded"),c=(t,e)=>(r,n)=>{r.forEach(r=>{(r.intersectionRatio>0||r.isIntersecting)&&(n.unobserve(r.target),s(r.target)||(t(r.target),i(r.target),e(r.target)))})},d=(t,e=document)=>t instanceof Element?[t]:t instanceof NodeList?t:e.querySelectorAll(t);var u=function(){function e(t){var r=t.max;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={max:r||100},this._caches=[]}var r,n,a;return r=e,(n=[{key:"has",value:function(t){return this._caches.indexOf(t)>-1}},{key:"add",value:function(t){this.has(t)||(this._caches.push(t),this._caches.length>this.options.max&&this.free())}},{key:"free",value:function(){this._caches.shift()}}])&&t(r.prototype,n),a&&t(r,a),e}(),p={name:"RokkaImgLazy",components:{RokkaImg:r},props:Object.assign({},r.props,{srcAttribute:{type:String,default:"data-src"},srcsetAttribute:{type:String,default:"data-srcset"},postfix:{type:[Object,Array],default:function(){return["1x","2x"]}},options:{type:[Object,Array],default:function(){return[{},{dpr:"2"}]}},operations:{type:[Object,Array],default:function(){return[]}},loading:{type:String,default:null}}),computed:{srcAdditionalComputed:function(){return!this.loading||this.isCached?"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=":(window._imageCache.add(this.rokkaRenderUrl),this.loading)},isCached:function(){return window._imageCache.has(this.rokkaRenderUrl)},rokkaRenderUrl:function(){return n({org:this.org,hash:this.hash,stack:this.stack,format:this.format,filename:this.filename,options:Array.isArray(this.options)?this.options[0]:this.options,variables:Array.isArray(this.variables)?this.variables[0]:this.variables})}},created:function(){window._imageCache||(window._imageCache=new u({max:200}))},updated:function(){window._lozadObserver.observe()},mounted:function(){window._lozadObserver||(window._lozadObserver=function(t=".lozad",e={}){const{root:r,rootMargin:n,threshold:a,load:u,loaded:p}=Object.assign({},o,e);let l;return"undefined"!=typeof window&&window.IntersectionObserver&&(l=new IntersectionObserver(c(u,p),{root:r,rootMargin:n,threshold:a})),{observe(){const e=d(t,r);for(let t=0;t<e.length;t++)s(e[t])||(l?l.observe(e[t]):(u(e[t]),i(e[t]),p(e[t])))},triggerLoad(t){s(t)||(u(t),i(t),p(t))},observer:l}}(".rokka--attr-data-src",{rootMargin:"200px"})),window._lozadObserver.observe()}};!function(t,e){void 0===e&&(e={});var r=e.insertAt;if(t&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===r&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}("");"undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var l=function(t,e,r,n,a,o,i,s,c,d){"boolean"!=typeof i&&(c=s,s=i,i=!1);const u="function"==typeof r?r.options:r;let p;if(t&&t.render&&(u.render=t.render,u.staticRenderFns=t.staticRenderFns,u._compiled=!0,a&&(u.functional=!0)),n&&(u._scopeId=n),o?(p=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,c(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},u._ssrRegister=p):e&&(p=i?function(t){e.call(this,d(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),p)if(u.functional){const t=u.render;u.render=function(e,r){return p.call(r),t(e,r)}}else{const t=u.beforeCreate;u.beforeCreate=t?[].concat(t,p):[p]}return r}({render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("rokka-img",{attrs:{org:t.org,hash:t.hash,filename:t.filename,stack:t.stack,format:t.format,alt:t.alt,"srcset-attribute":"data-srcset","src-attribute":"data-src","src-additional-attribute":"src","src-additional":t.srcAdditionalComputed,postfix:t.postfix,options:t.options}})},staticRenderFns:[]},void 0,p,"data-v-744333b7",!1,void 0,!1,void 0,void 0,void 0);module.exports={RokkaImgLazy:l,default:{install:function(t){t.component("rokka-img-lazy",l)}}}});
//# sourceMappingURL=index.umd.min.js.map
